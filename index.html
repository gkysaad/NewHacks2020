<!DOCTYPE html>
<html>
<head>
	<title>Vroom! You've Got a Match</title>
	<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
	<header>
		<h1 class="title"> VROOM! YOU'VE GOT A MATCH! </h1>
	</header>
	<br><br><br>
	<div class="filter">
		<form class="filter" action ="script.js">
			<label for="year"> Year:</label>
			<input type="text" id="year" name="year"><br><br>
			Make: <select id="makes">
				<option>Any Make</option>
				<optgroup>
					<option value="Acura">Acura</option>
					<option value="Audi">Audi</option>
					<option value="BMW">BMW</option>
					<option value="Buick">Buick</option>
					<option value="Cadillac">Cadillac</option>
					<option value="Chevrolet">Chevrolet</option>
					<option value="Chrysler">Chrysler</option>
					<option value="Dodge">Dodge</option>
					<option value="Ram">Ram</option>
					<option value="Ferrari">Ferrari</option>
					<option value="Ford">Ford</option>
					<option value="GMC">GMC</option>
					<option value="Honda">Honda</option>
					<option value="Hyundai">Hyundai</option>
					<option value="Infiniti">Infiniti</option>
					<option value="Jaguar">Jaguar</option>
					<option value="Jeep">Jeep</option>
					<option value="Kia">Kia</option>
					<option value="Lamborghini">Lamborghini</option>
					<option value="Land Rover">Land Rover</option>
					<option value="Lexus">Lexus</option>
					<option value="Lincoln">Lincoln</option>
					<option value="Maserati">Maserati</option>
					<option value="Mazda">Mazda</option>
					<option value="Mercedes-AMG">Mercedes-AMG</option>
					<option value="Mercedes-Benz">Mercedes-Benz</option>
					<option value="MINI">MINI</option>
					<option value="Mitsubishi">Mitsubishi</option>
					<option value="Nissan">Nissan</option>
					<option value="Porsche">Porsche</option>
					<option value="Ram">Ram</option>
					<option value="Subaru">Subaru</option>
					<option value="Tesla">Tesla</option>
					<option value="Toyota">Toyota</option>
					<option value="Volkswagen">Volkswagen</option>
					<option value="Volvo">Volvo</option></optgroup>
			</select><br><br>
			<label for="mileage"> Mileage Limit:</label>
			<input type="text" id="mileage" name="mileage"><br><br>
			<label for="price"> Price Limit:</label>
			<input type="text" id="price" name="price"><br><br><br>
			<button type="button" onclick="getInputValue();">Find Car</button>

			<script>
			var year;
			var make;
			var mil;
			var prc;
		 	function getInputValue(){
            // Selecting the input element and get its value 
            year = document.getElementById("year").value;
            make = document.getElementById("makes").value;
            mil = document.getElementById("mileage").value;
            prc = document.getElementById("price").value;

			var myHeaders = new Headers();
			myHeaders.append("User-Agent", "PostmanRuntime/7.22.0");
			myHeaders.append("Accept", "*/*");
			myHeaders.append("Cache-Control", "no-cache");
			myHeaders.append("Postman-Token", "55421f47-e803-4e6a-85f3-abf410923ae1");
			myHeaders.append("Host", "www.parsehub.com");
			myHeaders.append("Content-Type", "multipart/form-data; boundary=--------------------------180401260797681213179167");
			myHeaders.append("Accept-Encoding", "gzip, deflate, br");
			myHeaders.append("Content-Length", "638");
			myHeaders.append("Connection", "keep-alive");

			var formdata = new FormData();
			formdata.append("api_key", "tQY-a5ytQULq");
			formdata.append("start_url", "https://www.kijijiautos.ca/");
			formdata.append("send_email", "1");
			formdata.append("start_value_override", "{\"data\":[\n{\"make\": \"Toyota\", \n\"model\":\"RAV4\", \n\"year\":\"2015\",\n\"mileage\":\"10000\",\n\"price\":\"30000\"}]\n}");

			var requestOptions = {
			method: 'POST',
			//headers: myHeaders,
			mode: 'no-corps',
			body: formdata,
			redirect: 'follow'
			};

			fetch("https://www.parsehub.com/api/v2/projects/ttPuhXkthMpz/run", requestOptions)
			.then(response => response.text())
			.then(result => console.log(result))
			.catch(error => console.log('error', error));

			 }
			 /*
			let result = request.json();
			console.log(result);
			request(options, function (error, response) { 
			  if (error) throw new Error(error);
			  console.log(response.body);
			  var result = JSON.stringify(response.body["run_token"]);
			  return result;
			});
			}

/*
			await new Promise(r => setTimeout(r, 30000));

			var request = require('request');

			request({
			  uri: 'https://www.parsehub.com/api/v2/projects/'+ret+'/last_ready_run/data',
			  method: 'GET',
			  gzip: true,
			  qs: {
			    api_key: "tQY-a5ytQULq",
			    format: "json"
			  }
			}, function(err, resp, body) {
			  console.log(body);
			}); */
			</script>

		</form>	
		<img src="background.jpg">
</body>
</html>